<ion-header [translucent]="true">
  <ion-toolbar color="secondary">
    <ion-buttons slot="start">
      <ion-menu-button />
    </ion-buttons>
    <ion-title>List</ion-title>
  </ion-toolbar>

  <ion-toolbar color="success">
    <ion-searchbar />
    <ion-buttons slot="end">
      <ion-button (click)="clearList()">
        <ion-icon slot="icon-only" name="trash-bin-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">List</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)" pullFactor="0.8" pullMin="60" pullMax="120">
    <ion-refresher-content />
  </ion-refresher>

  @if (loading) {
  @for (item of items; track $index) {
  <ion-card>

    <ion-card-content class="ion-no-padding">
      <ion-item lines="none">
        <ion-avatar slot="start">
          <ion-skeleton-text />
        </ion-avatar>

        <ion-label>
          <ion-skeleton-text animated style="width: 150px"></ion-skeleton-text>

          <p>
            <ion-skeleton-text />
          </p>
        </ion-label>

        <ion-chip color="primary">
        </ion-chip>
      </ion-item>
    </ion-card-content>
  </ion-card>
  }
  }

  @for (user of users; track $index) {
  <ion-card (click)="openModal(user)">
    <ion-card-content class="ion-no-padding">
      <ion-item lines="none">
        <ion-avatar slot="start">
          <img [src]="user.picture.thumbnail" />
        </ion-avatar>

        <ion-label>
          {{user.name.first}} {{user.name.last}}
          <p>{{user.email}}</p>
        </ion-label>

        <ion-chip color="primary">
          <ion-label>{{user.nat}}</ion-label>
        </ion-chip>
      </ion-item>
    </ion-card-content>
  </ion-card>
  }

  <!-- display modal only if selectedUser is not null -->
  @if (selectedUser) {
  <ion-modal [isOpen]="selectedUser !== null" (ionModalDidDismiss)="closeModal()" [initialBreakpoint]="0.25"
    [breakpoints]="[0, 0.25, 0.5, 0.75]">
    <ng-template>
      <ion-header>
        <ion-toolbar color="light">
          <ion-buttons slot="start">
            <ion-button (click)="closeModal()">Close</ion-button>
          </ion-buttons>
          <ion-title>{{ selectedUser?.name.first }} {{ selectedUser?.name.last }}</ion-title>
        </ion-toolbar>
      </ion-header>

      <ion-content>
        Sheet
      </ion-content>
    </ng-template>
  </ion-modal>
  }
</ion-content>